# compiler settings
CXX = clang++

FLAGS =
CXXFLAGS = $(FLAGS) -I . -w -ferror-limit=3 -std=c++2a -I include -fpch-instantiate-templates -fpch-debuginfo -Xclang -fno-validate-pch -pthread

# source file and output

OUTPUT = lib/fan/pch.h.gch
OUTPUT_CPP = lib/fan/pch.o

ROOT_PATH = ./


DEBUG_FLAGS = -g
RELEASE_FLAGS = -mmmx -msse -msse2 -msse3 -mssse3 -msse4 -msse4.1 -O3 -fdata-sections -ffunction-sections

INCLUDES =

CXXFLAGS += -Dloco_imgui -DIMGUI_IMPL_OPENGL_LOADER_CUSTOM -DIMGUI_DEFINE_MATH_OPERATORS -Dloco_json

MAIN = $(ROOT_PATH)/fan/pch.h
MAIN_CPP = $(ROOT_PATH)/fan/pch.cpp

debug:
	$(CXX) $(CXXFLAGS) $(INCLUDES) $(DEBUG_FLAGS) -x c++-header $(MAIN) -o $(OUTPUT)
	$(CXX) -c $(CXXFLAGS) $(INCLUDES) $(DEBUG_FLAGS) -include-pch $(OUTPUT) $(MAIN_CPP) -o $(OUTPUT_CPP)
release:
	$(CXX) $(CXXFLAGS) $(INCLUDES) $(RELEASE_FLAGS) -x c++-header $(MAIN) -o $(OUTPUT)
	$(CXX) -c $(CXXFLAGS) $(INCLUDES) $(RELEASE_FLAGS) -include-pch $(OUTPUT) $(MAIN_CPP) -o $(OUTPUT_CPP)

clean:
	rm -f $(OUTPUT)
